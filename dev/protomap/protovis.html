<html>
<head>
	<title>Protovis and jQuery Slider Linear Scale example</title>
	<script type="text/javascript" src="js/protovis.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.15/jquery-ui.min.js"></script>
	<script type="text/javascript" src="js/protoSlider.js"></script>
	<script type="text/javascript" src="protoSliderBar.js"></script>
	<script type="text/javascript" src="protoSliderDonut.js"></script>
	<script type="text/javascript" src="js/protoSliderLoader.js"></script>
	<meta charset="utf-8"></meta>
<link rel="stylesheet" href="jquery-ui-1.8.15.custom.css">
<style>
	body { background-color: #000; }
	/*
	#wrapper { width: 500px; min-height: 400px; margin: auto; margin-top: 100px; border: 2px inset white; color: #fff; }
	#sliderwrap { width: 400px; margin-left: auto; margin-right: auto; }
	#slidercontrol { width: 150px; float: right; cursor: pointer; margin-top: 6px;}
	#addbars { width: 150px; float: right; }
	#addbars input { padding: 5px; color: #fff; background-color: #000; border: 1px solid white; font-weight: bold; cursor: pointer; }
	input.slider { border:0; color:#f6931f; font-weight:bold; }
	*/

</style>

<script type="text/javascript">
	

	var visSlide;
	var maxBars = 8; var m = 3;
   
  data11 = genData(maxBars, m);

  //Generate randomized data or use the static sampleChart and SampleDonut arrays 

   var data = new Object;
   data[2010] = genData(maxBars, m); data[2011] = genData(maxBars, m); data[2012] = genData(maxBars, m);
   data[2013] = genData(maxBars, m);
   var datakeys = new Array("AAAA","B","C","D","E","F","GGGG","H","I","J","K","L","M","N","O","P");
   var sampleChart = {
	   "2010":[[764.0840598614886,1410.090156365186,4202.549017500132],[2187.598670250736,1160.7372458092868,3858.163459226489],[4132.76451244019,454.97489778790623,1165.7911572838202],[1726.82415030431,844.09500437323,3260.1727733854204],[507.95340829063207,326.04380941484123,1893.5651803622022],[1289.1855355119333,1150.4885345930234,3120.8075755275786],[2645.8522060420364,4231.107777217403,3345.600036671385],[1262.4953188933432,8.78653849940747,3596.610074630007]],
	   "2011":[[489.59440633188933,2247.0762873999774,1372.4055932834744],[4463.172173243947,1121.2421675445512,3527.392112882808],[2849.7435942990705,3647.5197554100305,2090.9539981512353],[4196.295161149465,3033.4515661234036,3904.6820474322885],[2764.887851080857,2824.0394038148224,3333.429565653205],[1161.4083303138614,2889.1014670953155,3350.2841742010787],[159.18459661770612,39.69457803759724,319.5827775634825],[1514.1952807316557,2795.2694138512015,1013.214515754953]],
	   "2012":[[1089.3385936506093,197.5389429135248,2224.811666412279],[2246.681407559663,620.5024755327031,2289.915645495057],[1445.1704265084118,1716.213988373056,1578.9088297169656],[812.2350394260138,4331.397290574387,3000.9261053055525],[289.4319025799632,300.8699136553332,1655.6077867280692],[473.38520747143775,575.6746366387233,4175.380286411382],[4486.853401875123,971.01129591465,2390.7770697260275],[140.34195675048977,3422.009986708872,2760.6505444273353]],
	   "2013":[[2667.2608943190426,1488.8625657185912,3428.0005119508132],[3867.3497264971957,3565.3337007388473,1628.593955305405],[3700.2257534768432,2439.238215330988,294.00292318314314],[1022.2975148353726,1755.0101521192119,70.15322393272072],[757.4749920750037,2789.4262686604634,2778.800064814277],[2.235017716884613,1798.299821675755,1224.3680100655183],[3290.6921503599733,837.0679792715237,3681.016698712483],[2223.9317876519635,2711.728970403783,3608.099057106301]]};

  var sampleDonut = {
		   "2010":[[764.0840598614886,1410.090156365186],[2187.598670250736,1160.7372458092868],[4132.76451244019,454.97489778790623],[1726.82415030431,844.09500437323],[507.95340829063207,326.04380941484123],[1289.1855355119333,1150.4885345930234],[2645.8522060420364,4231.107777217403],[1262.4953188933432,8.78653849940747]],
		   "2011":[[489.59440633188933,2247.0762873999774],[4463.172173243947,1121.2421675445512],[2849.7435942990705,3647.5197554100305],[4196.295161149465,3033.4515661234036],[2764.887851080857,2824.0394038148224],[1161.4083303138614,2889.1014670953155],[159.18459661770612,39.69457803759724],[1514.1952807316557,2795.2694138512015]],
		   "2012":[[1089.3385936506093,197.5389429135248],[2246.681407559663,620.5024755327031],[1445.1704265084118,1716.213988373056],[812.2350394260138,4331.397290574387],[289.4319025799632,300.8699136553332],[473.38520747143775,575.6746366387233],[4486.853401875123,971.01129591465],[140.34195675048977,3422.009986708872]],
		   "2013":[[2667.2608943190426,1488.8625657185912],[3867.3497264971957,3565.3337007388473],[3700.2257534768432,2439.238215330988],[1022.2975148353726,1755.0101521192119],[757.4749920750037,2789.4262686604634],[2.235017716884613,1798.299821675755],[3290.6921503599733,837.0679792715237],[2223.9317876519635,2711.728970403783]]};


   //generate fake set of data
   function genData(rows, sets){
   		return pv.range(rows).map(function() {
    return pv.range(sets).map(function() {
        return Math.random()*4500 ;
      });
 	 });
   }


   $(document).ready(function(){
   		console.log("document ready");
   		var pLoader = new ProtoSliderLoader( {
   			opentag: 'data',
   			type: 'bar',
   			geoURL: 'qwi_geo.txt',
	   		url:'agegrp01001.xml',
	   		url2:'agegrp01000.xml',
	   		callback:loadData
	   	});
	   	pLoader.requestData();
   		
   });
	function loadData(dataObj){
   		console.log("Received data at callback");
   		console.log(dataObj);
   		loadVisSlide(dataObj);
   		$('#sliderBarSingle').html('<input value="draw single" type="button" onClick="visSlide.redrawSingle(0,1);"><input type="button" value="Draw All" onClick="visSlide.reloadGrouped();">');
   		//visSlide.groupInit();
   }
   function loadVisSlide(newData){
			console.log("load vis slide");
			visSlide.reloadData(newData);
			visSlideD.reloadData(newData);
			//visSlide.groupInit();
		}
   
	
</script>
<style>

#yearSliderHeight {
  
}

.ui-slider-horizontal {
}

#yearLabel {
  
  left: 0;
  width: 85;
  text-align: right;
}

#play {
  
  right: 50px;
  cursor: pointer;
}

#fast {
  
  right: 0px;
  cursor: pointer;
}
</style>

</head>
<body>


<div id="wrapper">
	<h2>Grouped Bar Chart Example</h2><hr>
	<div id="sliderBarSingle"></div>
	<div id="slidercontrol" class="protovisButtons">
	</div>
	<div id="sliderwrap" class="protovisWrap">	
	</div>
	<div id="chart">
		
		<script type="text/javascript+protovis" id="visSlideScript">
			
		visSlide = new ProtoSliderBar(datakeys, sampleChart,  {
			scriptID: "visSlideScript", 
			slideControls: "#slidercontrol", slideDiv: "#sliderwrap", 
			slideTimer: 1000, 
			minBars: 5, curBars: 6, labelX: "X Axis", labelY: "Y Axis",
			yScaleFormat: '$',  yScaleType: "linear", yScaleRootMax: 400,
			//scaleMax: 4500,
				yScaleInterval: 700,
			w: 400, h: 400, slideTimer: 1000 });
		
 		//visSlide.groupInit();
 		


		</script>

	</div>
	<div id="addbars">
		<input type=button value="+" onClick="$('#chart').ProtoSlider().slideAddBar();">
		<input type=button value="-" onClick="$('#chart').ProtoSlider().slideRemoveBar();">
	</div>
	<h2>Donut Chart Example</h2><hr>
	<div id="slidercontrolD" class="protovisButtons">
	</div>
	<div id="sliderwrapD" class="protovisWrap">	
	</div>
	<div id="donut">
		
		<script type="text/javascript+protovis" id="visSlideDScript">
		try {
		var visSlideD = new ProtoSliderDonut({
			scriptID: "visSlideDScript", 
			slideControls: "#slidercontrolD", slideDiv: "#sliderwrapD",
			yScaleFormat: "$", showBarTotals: false,
			w: 400, h: 400, slideTimer: 1000 });
 			//visSlideD.groupInit();
 		} catch (e) {
    		//echo 'Caught exception: '+  e->getMessage()+ "\n";
    		
		}


		</script>

	</div>
</div>


</body>
